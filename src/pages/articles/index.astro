---
import BaseLayout from "../../layouts/BaseLayout.astro";
import HorizontalCard from "../../components/HorizontalCard.astro";
import { getCollection } from "astro:content";

const articles = (await getCollection("articles")).sort(
  (a, b) => new Date(b.data.pubDate).valueOf() - new Date(a.data.pubDate).valueOf()
);
---

<script type="module">
  const input = document.getElementById("search");
  input?.addEventListener("input", () => {
    const keyword = input.value.toLowerCase();
    const cards = document.querySelectorAll(".article-card");
    cards.forEach((card) => {
      const text = card.innerText.toLowerCase();
      card.style.display = text.includes(keyword) ? "block" : "none";
    });
  });
</script>

<BaseLayout
  title="åŒ»å­¦è«–æ–‡ä¸€è¦§ | åŒ»ã‚¹ã‚¯ï¼"
  description="åŒ»ã‚¹ã‚¯ï¼ãŒå³é¸ã—ãŸåŒ»å­¦è«–æ–‡ã®ä¸€è¦§ãƒšãƒ¼ã‚¸ã€‚ç ”ç©¶è€…ãƒ»åŒ»ç™‚å¾“äº‹è€…ãƒ»ä¸€èˆ¬ã®æ–¹å‘ã‘ã«ã€ä¿¡é ¼ã§ãã‚‹åŒ»å­¦è«–æ–‡ã‚’ã‚ã‹ã‚Šã‚„ã™ãç´¹ä»‹ã—ã¦ã„ã¾ã™ã€‚"
  image="/ogp.png"
  url="https://isuku.jp/articles"
  sideBarActiveItemID="articles"
>
  <section class="max-w-4xl mx-auto px-6 py-12">
    <h1 class="text-4xl font-bold mb-6">ğŸ—‚ åŒ»å­¦è«–æ–‡ ä¸€è¦§</h1>

    <div class="mb-8">
      <input
        id="search"
        type="text"
        placeholder="ğŸ” ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§æ¤œç´¢ï¼ˆä¾‹ï¼šè„³å’ä¸­ã€ãƒ¡ã‚¿è§£æï¼‰"
        class="input input-bordered w-full"
      />
    </div>

    {articles.length === 0 ? (
      <p class="text-gray-500 dark:text-gray-400">è¨˜äº‹ãŒã¾ã ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
    ) : (
      <div class="space-y-6">
        {articles.map(({ slug, data }) => (
          <div class="article-card">
            <HorizontalCard
              title={data.title}
              desc={data.description}
              img={data.heroImage}
              url={`/articles/${slug}`}
              badge="è«–æ–‡"
              tags={data.tags}
            />
          </div>
        ))}
      </div>
    )}
  </section>
</BaseLayout>
